{% extends "base.html" %}

{% block title %}Znajdź przewodnika - GuideSwipe{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12 text-center">
            <h2 class="fw-bold mb-2" data-aos="fade-down">
                <i class="fas fa-search me-2"></i>Znajdź idealnego przewodnika
            </h2>
            <p class="text-muted" data-aos="fade-down" data-aos-delay="100">
                Swipuj w prawo jeśli ktoś Ci się podoba, w lewo jeśli nie
            </p>
        </div>
    </div>

    <!-- Swipe Interface -->
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <!-- Swipe Container (wykorzystuje CSS/JS osoby A) -->
            <div class="swipe-container" data-aos="zoom-in">
                <div class="loading text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Ładowanie profili...</span>
                    </div>
                    <p class="mt-3 text-muted">Szukamy najlepszych przewodników...</p>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons" data-aos="fade-up" data-aos-delay="300">
                <button class="action-btn btn-dislike" title="Nie podoba mi się">
                    <i class="fas fa-times"></i>
                </button>
                <button class="action-btn btn-superlike" title="Super like!">
                    <i class="fas fa-star"></i>
                </button>
                <button class="action-btn btn-like" title="Podoba mi się">
                    <i class="fas fa-heart"></i>
                </button>
            </div>
            
            <!-- Instructions -->
            <div class="instructions text-center mt-4" data-aos="fade-up" data-aos-delay="400">
                <div class="row g-3">
                    <div class="col-4">
                        <div class="instruction-item">
                            <div class="instruction-icon text-danger">
                                <i class="fas fa-arrow-left fa-2x"></i>
                            </div>
                            <small class="text-muted">Swipe w lewo<br>lub kliknij <i class="fas fa-times"></i></small>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="instruction-item">
                            <div class="instruction-icon text-primary">
                                <i class="fas fa-arrow-up fa-2x"></i>
                            </div>
                            <small class="text-muted">Super like<br>lub kliknij <i class="fas fa-star"></i></small>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="instruction-item">
                            <div class="instruction-icon text-success">
                                <i class="fas fa-arrow-right fa-2x"></i>
                            </div>
                            <small class="text-muted">Swipe w prawo<br>lub kliknij <i class="fas fa-heart"></i></small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Filters (Optional) -->
    <div class="row justify-content-center mt-5">
        <div class="col-lg-6 col-md-8">
            <div class="card border-0 shadow-sm" data-aos="fade-up">
                <div class="card-header bg-white">
                    <h6 class="mb-0">
                        <i class="fas fa-filter me-2"></i>Filtry
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label small">Miasto</label>
                            <select class="form-select form-select-sm" id="cityFilter">
                                <option value="">Wszystkie miasta</option>
                                <option value="Kraków">Kraków</option>
                                <option value="Warszawa">Warszawa</option>
                                <option value="Gdańsk">Gdańsk</option>
                                <option value="Wrocław">Wrocław</option>
                                <option value="Poznań">Poznań</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small">Specjalizacja</label>
                            <select class="form-select form-select-sm" id="specialtyFilter">
                                <option value="">Wszystkie</option>
                                <option value="Food Tours">Food Tours</option>
                                <option value="History Tours">Historia</option>
                                <option value="Art Tours">Sztuka</option>
                                <option value="Nightlife">Nocne życie</option>
                                <option value="Active Tours">Aktywne</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small">Maksymalna cena (punkty)</label>
                            <input type="range" class="form-range" id="priceFilter" min="10" max="50" value="50">
                            <div class="d-flex justify-content-between">
                                <small class="text-muted">10 pts</small>
                                <small class="text-muted" id="priceValue">50 pts</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small">Minimalna ocena</label>
                            <select class="form-select form-select-sm" id="ratingFilter">
                                <option value="0">Wszystkie</option>
                                <option value="4.5">4.5⭐ i wyżej</option>
                                <option value="4.0">4.0⭐ i wyżej</option>
                                <option value="3.5">3.5⭐ i wyżej</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <div class="d-flex gap-2">
                                <button class="btn btn-primary btn-sm" onclick="applyFilters()">
                                    <i class="fas fa-check me-1"></i>Zastosuj
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="resetFilters()">
                                    <i class="fas fa-undo me-1"></i>Resetuj
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Match Popup (will be inserted by SwipeManager) -->
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/swipe.js') }}"></script>
<script src="{{ url_for('static', filename='js/animations.js') }}"></script>
<script>
// Filter functionality
document.getElementById('priceFilter').addEventListener('input', function() {
    document.getElementById('priceValue').textContent = this.value + ' pts';
});

function applyFilters() {
    const filters = {
        city: document.getElementById('cityFilter').value,
        specialty: document.getElementById('specialtyFilter').value,
        maxPrice: document.getElementById('priceFilter').value,
        minRating: document.getElementById('ratingFilter').value
    };
    
    // This would reload profiles with filters
    if (window.swipeManager) {
        window.swipeManager.loadProfiles(filters);
    }
    
    showToast('Filtry zostały zastosowane', 'success');
}

function resetFilters() {
    document.getElementById('cityFilter').value = '';
    document.getElementById('specialtyFilter').value = '';
    document.getElementById('priceFilter').value = '50';
    document.getElementById('priceValue').textContent = '50 pts';
    document.getElementById('ratingFilter').value = '0';
    
    applyFilters();
}

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    if (window.swipeManager) {
        switch(e.key) {
            case 'ArrowLeft':
                window.swipeManager.swipeCard('left');
                break;
            case 'ArrowRight':
                window.swipeManager.swipeCard('right');
                break;
            case 'ArrowUp':
                window.swipeManager.swipeCard('up');
                break;
        }
    }
});
</script>
{% endblock %}

{% block extra_css %}
<style>
.instruction-item {
    padding: 10px;
    border-radius: 10px;
    transition: transform 0.2s ease;
}

.instruction-item:hover {
    transform: scale(1.05);
    background: rgba(0,0,0,0.02);
}

.instruction-icon {
    margin-bottom: 8px;
}
</style>
{% endblock %}
